[
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_add(a, b):\n    # Vulnerable: No check before adding.\n    result = a + b\n    return result",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Arithmetic Addition without Check: The function adds two integers without verifying if the result exceeds the maximum uint64 value.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_subtract(balance, amount):\n    # Vulnerable: No check for underflow.\n    new_balance = balance - amount\n    return new_balance",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Arithmetic Subtraction without Check: The function subtracts an amount from balance without ensuring the amount is less than or equal to the balance.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_multiply(items, price):\n    # Vulnerable: No check for overflow.\n    total_cost = items * price\n    return total_cost",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Arithmetic Multiplication without Check: The function multiplies values without checking if the result exceeds the maximum allowed integer size.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_update_score(score, points):\n    # Panics on overflow\n    return score + points",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unchecked Accumulation: Adding points to a score without an overflow check can cause the contract to panic and fail unexpectedly.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_burn_tokens(supply, burn_amount):\n    # Panics on underflow\n    return supply - burn_amount",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unchecked Token Burn: Subtracting from supply without checking if burn_amount exceeds supply allows for potential underflow panics.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_calc_interest(principal, rate):\n    # Panics on overflow\n    return principal * rate",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unchecked Interest Calculation: Multiplication of principal and rate is performed without ensuring the result fits within uint64.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.none)\ndef vulnerable_update_balance(user, amount):\n    current_balance = App.localGet(user, Bytes(\"balance\"))\n    # Vulnerable: The '+' operation can panic\n    new_balance = current_balance + amount\n    return App.localPut(user, Bytes(\"balance\"), new_balance)",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unsafe Balance Update: Updating user balance in local state without checking for overflow before the addition operation.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.none)\ndef vulnerable_withdraw(user, amount):\n    current_balance = App.localGet(user, Bytes(\"balance\"))\n    # Vulnerable: The '-' operation can panic\n    new_balance = current_balance - amount\n    return App.localPut(user, Bytes(\"balance\"), new_balance)",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unsafe Withdrawal: Decreasing user balance without first asserting that the current balance is greater than or equal to the withdrawal amount.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_get_scaled_value(val):\n    # Vulnerable: Multiplying by a constant can still overflow\n    scaled_val = val * Int(1000)\n    return scaled_val",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unchecked Scaling: Multiplying an input value by a large constant (1000) without checking if the input is small enough to prevent overflow.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef vulnerable_complex(a, b, c):\n    # This can panic at the '+' or the '-' step\n    result = (a + b) - c\n    return result",
        "output": "Status: VULNERABLE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Unchecked Composite Operation: Contains multiple arithmetic steps (addition then subtraction) without validating safety at each step.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_add(a, b):\n    # Safe: We check for overflow *before* adding.\n    return Seq(\n        Assert(a <= (Global.max_int() - b)),\n        Return(a + b)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Checked Addition: Explicitly asserts that the addition will not exceed the global maximum integer value before performing the operation.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_subtract(balance, amount):\n    # Safe: We check for underflow *before* subtracting.\n    return Seq(\n        Assert(balance >= amount),\n        Return(balance - amount)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Checked Subtraction: Asserts that the balance is sufficient to cover the amount before subtraction, preventing underflow.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_multiply(items, price):\n    # Safe: Multiplication check\n    return Seq(\n        If(Or(items == Int(0), price == Int(0)),\n            Return(Int(0))\n        ,\n            Seq(\n                Assert(items <= (Global.max_int() / price)),\n                Return(items * price)\n            )\n        )\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Checked Multiplication: Uses division to verify that the product of items and price will not exceed the maximum integer limit.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_update_score(score, points):\n    # Safe check\n    return Seq(\n        Assert(score <= (Global.max_int() - points)),\n        Return(score + points)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Score Update: Implements a pre-check assertion to ensure the score addition remains within safe bounds.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_burn_tokens(supply, burn_amount):\n    # Safe check\n    return Seq(\n        Assert(supply >= burn_amount),\n        Return(supply - burn_amount)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Token Burn: Validates that the supply is sufficient for the burn amount before executing the subtraction.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_calc_interest(principal, rate):\n    # Safe check\n    return Seq(\n        If(principal == Int(0),\n            Return(Int(0))\n        ,\n            Seq(\n                Assert(rate <= (Global.max_int() / principal)),\n                Return(principal * rate)\n            )\n        )\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Interest Calculation: Properly checks for overflow during multiplication and handles zero principal edge cases.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.none)\ndef safe_update_balance(user, amount):\n    current_balance = App.localGet(user, Bytes(\"balance\"))\n    # Safe: Check *before* adding\n    return Seq(\n        Assert(current_balance <= (Global.max_int() - amount)),\n        App.localPut(user, Bytes(\"balance\"), current_balance + amount)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Balance Update: Protects the local state update by asserting the new balance does not overflow before writing.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.none)\ndef safe_withdraw(user, amount):\n    current_balance = App.localGet(user, Bytes(\"balance\"))\n    # Safe: Check *before* subtracting\n    return Seq(\n        Assert(current_balance >= amount),\n        App.localPut(user, Bytes(\"balance\"), current_balance - amount)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Withdrawal: Protects the withdrawal logic by asserting sufficient balance exists before performing the subtraction.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_get_scaled_value(val):\n    # Safe: Check for overflow\n    return Seq(\n        Assert(val <= (Global.max_int() / Int(1000))),\n        Return(val * Int(1000))\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Scaling: Checks if the input value can be safely multiplied by the scaling factor (1000) without overflowing.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    },
    {
        "instruction": "You are a smart contract security analyzer. Your task is to analyze the provided PyTeal code for Algorand and identify Integer Overflow and Underflow vulnerabilities (OWASP V8).",
        "input": "@Subroutine(TealType.uint64)\ndef safe_complex(a, b, c):\n    # We must check *both* steps.\n    return Seq(\n        Assert(\n            And(\n                a <= (Global.max_int() - b),\n                (a + b) >= c\n            )\n        ),\n        Return((a + b) - c)\n    )",
        "output": "Status: SAFE\nVulnerability: V8 - Integer Overflow and Underflow\nAnalysis: Safe Composite Operation: Validates both the addition (no overflow) and the subsequent subtraction (no underflow) before executing the logic.",
        "meta_platform": "Algorand",
        "meta_vuln_type": "V8 - Integer Overflow and Underflow"
    }
]
